<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/header-footer.css" />
		<link rel="stylesheet" type="text/css" href="css/shopCar.css" />
	</head>

	<body>
		<div id="top">
			<div id="place">上海 ▼</div>
			<p>
				<a href="xingyd.html">星夜达</a>
			</p>
			<ul>
				<li>
					<a href="denglu.html" target="_blank" id="hello">[登录]</a>
				</li>
				<li>
					<a href="zhuce.html" id="tuichu">[注册<span>有惊喜</span>]</a>
				</li>
				<li>
					<a href="">我的果园</a>
				</li>
				<li>
					<a href="">手机果园</a>
				</li>
				<li>
					<a href="">联系客服</a>
				</li>
			</ul>
		</div>
		<div id="place_block">
			<p>热门城市：</p>
			<p>
				<a href="#">上海</a>
				<a href="#">广州</a>
				<a href="#">北京</a>
				<a href="#">苏州</a>
				<a href="#">南京</a>
				<a href="#">深圳</a>
			</p>
			<p>选择城市：</p>
			<ul>
				<li>上海</li>
				<li>上海崇明</li>
				<li><span>江苏</span><span></span></li>
				<li><span>浙江</span><span></span></li>
				<li><span>安徽</span><span></span></li>
				<li>北京</li>
				<li>天津</li>
				<li><span>河北</span><span></span></li>
				<li><span>广东</span><span></span></li>
			</ul>
		</div>
		<div id="header">
			<img src="img/images/logo.png" id="img01" />
			<div id="mycar"></div>
			<!--<ul>
				<li>
					<a href="">首页<br/>Home</a>
				</li>
				<li>
					<a href="fruit.html">鲜果<br/>Fruit</a>
				</li>
				<li>
					<a href="fresh.html">生鲜<br/>Fresh</a>
				</li>
				<li>
					<a href="">礼品<br/>Gigt</a>
				</li>
				<li>
					<a href="">会员中心<br/>VIP Club</a>
				</li>
			</ul>
			<div id="shousuo">
				<input type="text" name="" id="" placeholder="请输入关键字" />
				<img src="img/images/20170902145509.png" />
				<div id="shop_car">购物车<span>(0)</span></div><br />
				<div>热门：
					<a href="#">橙</a>
					<a href="">提子</a>
					<a href="">樱桃</a>
					<a href="">苹果</a>
				</div>
			</div>-->

		</div>

		<div id="shopCar">
			<div id="shopCar_header">我的购物车
				<a href="fresh.html">继续逛逛></a>
			</div>
			<div id="shopCar_main">
				<div id="xinxi"><span>商品</span><span>规格</span><span>单价（元）</span><span>数量</span><span>原价（元）</span><span>操作</span></div>
				<div id="shopCar_no">购物车中还没有商品，
					<a href="fresh.html">继续逛逛</a>吧！</div>
				<ul id="shopCar_list">
					<!--<li>
						<a href="page.html"><img src="img/images/show_s_01.jpg"/></a>
						<span><a href="page.html">泰森鸡中翅</a></span>
						<span>300-400g</span>
						<span>￥29.90元</span>
						<div><p><span>-</span><span>1</span><span>+</span></p></div>
						<span>￥29.9</span>
						<span>删除</span>
					</li>-->
				</ul>

			</div>
			<div id="pay">
				<span>已选择 <em></em> 件商品|订单金额</span>
				<span id="zongjia"></span>
				<span id="gopay">去结算</span>
			</div>
		</div>

		<div id="xuanfu">
			<ul>
				<li>卡券<br/>兑换</li>
				<li>客服</li>
				<li id="xuanfu_li3">TOP↑</li>
			</ul>
		</div>
		<div id="footer">
			<div id="footer_box01">
				<img src="img/images/20170902171324.png" id="footer_img01" />
				<p>电话客服<span>09：00-21：00</span></p>
				<p>在线客服<span>08：00-24：00</span></p>
			</div>
			<div id="footer_box02">
				<img src="img/images/20170902172346.png" />
				<span>天天果园官方微信</span>
			</div>
			<div id="footer_box03">
				<img src="img/images/20170902172402.png" />
				<span>天天果园APP</span>
			</div>
			<div id="footer_box04">
				<ul class="u1">

					<li>购物指南</li>
					<li>配送说明</li>
					<li>售后服务</li>
					<li>企业服务</li>
				</ul>
				<ul class="u2">
					<li>
						<a href="#">新用户注册</a>
					</li>
					<li>
						<a href="#">运费说明</a>
					</li>
					<li>
						<a href="#">退换货规则</a>
					</li>
					<li>
						<a href="#">企业订购</a>
					</li>
					<li>
						<a href="#">在线下单</a>
					</li>
					<li>
						<a href="#">运费方式</a>
					</li>
					<li>
						<a href="#">服务保障承诺</a>
					</li>
					<li>
						<a href="#">公司简介</a>
					</li>
					<li>
						<a href="#">支付方式</a>
					</li>
					<li>
						<a href="#">发票说明</a>
					</li>
					<li>
						<a href="#">验货与签收</a>
					</li>
					<li>
						<a href="#">定制专区</a>
					</li>
				</ul>
			</div>

		</div>
		<div id="bottom">
			<p class="p1">版权所有 ©2017上海天天鲜果电子商务有限公司  保留所有权利 | 沪ICP备12042163</p>
			<p class="p2">天天果园  鲜果网购</p>
			<a href="#"><img src="img/images/guan_wgdjp.png" /></a>
		</div>
	</body>

</html>
<script src="jquery-1.11.1.min.js"></script>
<script src="cookie.js"></script>
<script type="text/javascript">
	$("#xuanfu_li3").click(function() {
		$("body,html").animate({
			scrollTop: 0
		}, 1000)
	})

	$(function() {
		var arr = getCookie("shoplist");
		setCookie("gouwuche",arr.length)
		
		
		var brr = getCookie("userNumber")
	    
	    $("#hello").text("您好," + brr);
	    
		
		var html = "";
		for(var i in arr) {
			var shopinfo = arr[i];
			html += '<li>'+
						'<img src="img/images/'+shopinfo.src+'"'+'/>'+
						'<span>'+shopinfo.name+'</span>'+
						'<span>'+shopinfo.guige+'</span>'+
						'<span>￥'+shopinfo.price+'</span>'+
						'<div><p><span class="jiajian">-</span><span class="num">'+shopinfo.count+'</span><span class="jiajian">+</span></p></div>'+
						'<span id="yuanjia" data-id='+shopinfo.id+' data-name='+shopinfo.name+' data-src='+shopinfo.src+' data-price='+shopinfo.price+' data-count='+shopinfo.count+' >￥'+(shopinfo.price*shopinfo.count).toFixed(1)+'</span>'+
						'<span class="del">删除</span>'+
					'</li>'

		}
		
		$("#shopCar_list").html(html);
		$("#shopCar_list").on("click", ".del", function() {
			var id = $(this).parent().find("#yuanjia").data("id");
			var pname = $(this).parent().find("#yuanjia").data("name");
			var f = confirm("确定删除吗？");
			if(f) {
				for(var i in arr) {
					if(id == arr[i].id && pname == arr[i].name) {
						arr.splice(i, 1);

						setCookie("shoplist", JSON.stringify(arr));

						$(this).parent().remove();
					}
				}
				jiesuan()
			}
		})
		$(".jiajian").click(function() {
			var sign = $(this).html();
			var id = $(this).parent().parent().next().data("id");
			var pname = $(this).parent().parent().next().data("name");
			
			var num = $(this).parent().parent().find(".num").html();
			if(sign == "-" && num == 1) {
				return;
			}
			for(var i in arr) {
				if(id == arr[i].id && pname == arr[i].name) {
					sign == "+" ? arr[i].count++ : arr[i].count--;
					setCookie("shoplist", JSON.stringify(arr));
					$(this).parent().parent().find(".num").html(arr[i].count);
					$(this).parent().parent().next().html("￥"+(arr[i].count * arr[i].price).toFixed(1));
				}
			}
			if(sign == "+"){
				jiesuan()
			}if(sign == "-"){
				jiesuan()
			}
			
		})
		
		jiesuan()
		function jiesuan() {
			var money = 0;
			var count = 0;
			for(var i in arr){
				var shopinfo = arr[i]
				count += parseInt(shopinfo.count) 
				money+=shopinfo.count*shopinfo.price
			}
			money=money.toFixed(1); 
			
			$("#pay em").html(count);
			$("#zongjia").html("￥"+money)
		}
		
	})
	
	$("#gopay").click(function(){
		var arr = $("#zongjia").text()
		setCookie("zongjia", arr);
		location.href= "jiesuan.html"
	})
	
</script>